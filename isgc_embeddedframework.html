<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>CIF v2 Test</title>

    <!-- Official CIF v2 SDK -->
    <script src="https://appsforcrm.microsoft.com/sdk/cif/2.0/MSDyn_ChannelIntegrationFramework.js"></script>
  </head>
  <body style="font-family: Arial; padding: 20px">
    <h1>CIF v2 Test Page</h1>
    <p>Iframe loaded correctly.</p>

    <button onclick="sendTest()">Send Test Event</button>

    <script>
      Microsoft.CIFramework.initialize().then(() => {
        console.log("CIF v2 initialized");
      });

      function sendTest() {
        Microsoft.CIFramework.notifyEvent("TestEvent", {
          text: "Hello from iframe",
        });
      }
    </script>
  </body>
</html>
